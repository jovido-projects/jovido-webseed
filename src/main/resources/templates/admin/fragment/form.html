<html xmlns:th="http://www.thymeleaf.org"
      xmlns:cp="http://www.getwebseed/dialect/cp"
      th:remove="tag">

<th:block th:with="form = ${self}">
    <th:block th:each="e : ${form.fieldsByAttributeName}"
              th:with="fields = ${e.value}, attributeName = ${e.key}">

        <fieldset>
            <legend th:text="${attributeName}"></legend>
            <th:block th:each="field : ${fields}">
                <th:block cp:replace="${field}" />
            </th:block>
        </fieldset>

    </th:block>
</th:block>
</html>