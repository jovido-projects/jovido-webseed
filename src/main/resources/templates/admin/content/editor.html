<html xmlns:th="//www.thymeleaf.org"
      th:replace="/admin(
      objectName='contentAdministration',
      main=~{::default},
      breadcrumbs=~{::breadcrumbs})"
      th:remove="tag">

<th:block th:fragment="breadcrumbs">

    <th:block th:fragment="dependent(payload)">
        <th:block th:if="${payload}">
            <th:block th:replace="::dependent(${payload.field.fragment.referringPayload})" />
            <li>
                <span th:text="${payload?.field?.name}">Field Name</span>
                [<span th:text="${payload?.ordinal}">#</span>]
            </li>
        </th:block>
    </th:block>

    <li>
        <span th:text="${item}">Item name</span>
    </li>
    <th:block th:if="${fragment?.referred}">
        <th:block th:replace="::dependent(${fragment?.referringPayload})" />
    </th:block>


</th:block>

<div th:fragment="default" th:with="structure=${@itemService.getStructure(editor.fragment)}">

    <th:block th:if="${editor.item?.id != null}">
        <input type="hidden" th:name="id" th:value="${editor?.item?.id}">
    </th:block>
    <th:block th:if="${editor.item?.id == null}">
        <input type="hidden" th:name="new" th:value="${structure?.name}">
    </th:block>

    <ul th:if="${#fields.hasErrors('editor.*')}">
        <li th:each="err : ${#fields.detailedErrors('editor.*')}" >
            <span th:text="${err}">Error</span>
        </li>
    </ul>

    <div class="row">

        <!-- Content -->
        <div class="col-md-7" th:with="fragment=${editor.fragment}">

            <h2>
                <span th:text="#{seed.structure.__${structure?.name}__}">Title</span>
            </h2>
            <ul class="breadcrumb">
                <th:block th:replace="::breadcrumbs" />
            </ul>

            <!-- Fields -->
            <th:block th:each="attribute : ${structure?.attributes}"
                      th:with="field=${fragment?.getField(attribute.fieldName)}">

                <th:block th:switch="${attribute.class.simpleName}">
                    <th:block th:case="'TextAttribute'">
                        <th:block th:unless="${attribute.multiline}">
                            <th:block th:replace="admin/content/editor/text-field" />
                        </th:block>
                        <th:block th:if="${attribute.multiline}">
                            <th:block th:replace="admin/content/editor/multiline-text-field" />
                        </th:block>
                    </th:block>
                    <th:block th:case="'FragmentAttribute'">
                        <th:block th:replace="admin/content/editor/fragment-field" />
                    </th:block>
                </th:block>
            </th:block>


            <!-- Editor actions (save, delete, ...) -->
            <div class="btn-group">
                <button class="btn btn-primary"
                        th:formaction="@{save}">
                    <i class="fa fa-floppy-o"></i>
                    Save
                </button>
                <button class="btn btn-success" th:if="${!fragment.referred}"
                        th:formaction="@{activate}">
                    <i class="fa fa-bullhorn"></i>
                    Activate
                </button>
                <!--<a class="btn btn-success"-->
                   <!--th:href="@{validate}">-->
                    <!--<i class="fa fa-check"></i>-->
                    <!--Check-->
                <!--</a>-->
                <button class="btn btn-danger" th:if="${!fragment.referred}"
                        disabled="disabled"
                        th:formaction="@{delete}" >
                    <i class="fa fa-trash"></i>
                    Delete
                </button>
                <a class="btn btn-default" th:if="${fragment.referred}"
                   th:href="@{close}">
                    <i class="fa fa-times"></i>
                    Close
                </a>
                <a class="btn btn-info" th:if="${!fragment.referred}"
                   th:href="@{/item(id=${editor.item.id})}">
                    <i class="fa fa-eye"></i>
                    Preview
                </a>
            </div>
        </div>

        <!-- Sidebar -->
        <div class="col-md-5">

            <h2>
                <span>&nbsp;</span>
            </h2>

            <table class="table ">
                <tbody>
                <tr>
                    <th>ID</th>
                    <td>
                        <span th:text="${editor.item.id}">ID</span>
                    </td>
                </tr>
                <tr>
                    <th>Locale</th>
                    <td>
                        <span th:text="${editor.item.locale?.displayName}">Locale</span>
                    </td>
                </tr>
                <tr>
                    <th>Structure</th>
                    <td>
                        <span th:text="${structure?.name}">Structure</span>
                    </td>
                </tr>
                <tr>
                    <th>Dependent</th>
                    <td>
                        <span th:text="${editor?.fragment?.referred}">True/False</span>
                    </td>
                </tr>
                <tr>
                    <th>Active Fragment</th>
                    <td>
                        <span th:text="${editor?.item?.activeFragment?.id}">?</span>
                    </td>
                </tr>

                </tbody>
            </table>

            <div class="form-group">
                <label>Title</label>
                <input class="form-control" type="text" th:field="*{editor.fragment.title}">
            </div>
            <div class="form-group">
                <label>Path</label>
                <input class="form-control" type="text" th:field="*{editor.fragment.path}">
            </div>
        </div>
    </div>
</div>
</html>