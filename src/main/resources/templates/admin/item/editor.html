<html xmlns:th="//www.thymeleaf.org" th:remove="tag">
<th:block th:with="nestedPath='self',nestingLevel=0">
    <th:block th:fragment="fields" th:with="nestingLevel=${nestingLevel+1}">
        <th:block th:with="editor=*{__${nestedPath}__},structure=${editor.structure}">
            <th:block th:each="attribute,attributeItr : ${structure.attributes}">
                <th:block th:with="group=${editor.fieldGroups[attribute.name]}">
                    <p th:if="${attributeItr.index > 0}"></p>
                    <th:block th:replace="__${group.template}__" />
                </th:block>
            </th:block>
        </th:block>
    </th:block>
</th:block>
</html>