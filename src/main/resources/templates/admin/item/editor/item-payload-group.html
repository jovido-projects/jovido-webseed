<html xmlns:th="//www.thymeleaf.org" th:remove="tag">

<div class="form-group" th:each="payload,payloadItr : ${group.payloads}">
    <th:block>
        <h4>
            <span th:text="${payload.target?.structureName}">Structure name</span>
            <span th:if="${group.payloads.size() > 1}">#[[${payloadItr.index + 1}]]</span>
            <i th:if="${attribute.isLabel()}" class="fa fa-tag" th:title="#{seed.attribute.label}"></i>
            <small th:text="${attribute.name}">Attribute name</small>



        <div class="btn-group btn-group-xs pull-right" th:remove="${group.length() >= attribute.capacity} ? all : _">
            <button class="btn btn-default" th:if="${!payload.compressed}"
                    th:formaction="@{close-payload(
                    nested-path=${nestedPath},
                    attribute=${attribute.name},
                    index=${payloadItr.index})}">
                <i class="fa fa-compress"></i>
            </button>
            <button class="btn btn-default" th:if="${payload.compressed}"
                    th:formaction="@{open-payload(
                    nested-path=${nestedPath},
                    attribute=${attribute.name},
                    index=${payloadItr.index})}">
                <i class="fa fa-expand"></i>
            </button>
            <th:block th:replace="admin/item/editor/payload-actions" />
        </div>
        </h4>
    </th:block>

    <th:block th:if="${!payload.compressed}">
        <th:block th:replace="admin/item/editor/item-payload" />
    </th:block>
    <th:block th:if="${payload.compressed}">
        :)
    </th:block>

</div>
<th:block th:remove="${group.length() >= attribute.capacity} ? all : _">
    <div class="btn-group dropup">
        <button type="button" th:disabled="${group.length() >= attribute.capacity} ? disabled : _"
                class="btn btn-default dropdown-toggle"
                data-toggle="dropdown"
                aria-haspopup="true"
                aria-expanded="false">
            Append <span class="caret"></span>
        </button>
        <ul class="dropdown-menu">
            <li th:each="structureName : ${attribute.acceptedStructureNames}">
                <a th:href="@{append(
                    nested-path=${nestedPath},
                    attribute=${attribute.name},
                    structure=${structureName})}">
                    <span th:text="#{seed.structure.__${structureName}__}">Name</span>
                </a>
            </li>
        </ul>
    </div>
</th:block>

</html>