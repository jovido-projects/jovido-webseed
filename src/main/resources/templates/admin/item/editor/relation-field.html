<html xmlns:th="//www.thymeleaf.org" th:remove="tag">
<label>
    <span th:text="${attribute.name}">Field name</span>
</label>
<div class="">
    <ul class="list-group" >

        <li class="list-group-item" th:classappend="nesting-level-__${nestingLevel}__"
            th:each="target,targetItr : ${payload?.value?.targets}">

            <h4 th:with="structure=${@itemService.getStructure(target)}">
                <span th:text="${targetItr.index + 1}">Target index</span>.
                <span th:text="${structure.name}">Relation name</span>

                <div class="btn-group btn-group-xs pull-right">
                    <button class="btn btn-default"
                            th:formaction="@{move-relation-up(
                            nested-path=${nestedPath},
                            attribute=${attribute.name},
                            index=${targetItr.index})}">
                        <i class="fa fa-arrow-up"></i>
                    </button>
                    <button class="btn btn-default"
                            th:formaction="@{move-relation-down(
                            nested-path=${nestedPath},
                            attribute=${attribute.name},
                            index=${targetItr.index})}">
                        <i class="fa fa-arrow-down"></i>
                    </button>
                    <button class="btn btn-default"
                            th:formaction="@{remove-relation(
                            nested-path=${nestedPath},
                            attribute=${attribute.name},
                            index=${targetItr.index})}">
                        <i class="fa fa-remove"></i>
                    </button>
                </div>
            </h4>

            <th:block th:with="nestedPath='__${nestedPath}__.payloads[__${attribute.name}__].value.targets[__${targetItr.index}__]'">
                <th:block th:replace="admin/item/editor::fields" />
            </th:block>

        </li>

        <li class="list-group-item" th:classappend="nesting-level-__${nestingLevel}__">
            <div class="btn-group">
                <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    Append <span class="caret"></span>
                </button>
                <ul class="dropdown-menu">
                    <li th:each="structureName : ${attribute.acceptedStructureNames}">
                        <a th:href="@{add-relation(
                    nested-path=${nestedPath},
                    attribute=${attribute.name},
                    structure=${structureName})}">
                            <span th:text="${structureName}">Name</span>
                        </a>
                    </li>
                </ul>
            </div>
        </li>


    </ul>
</div>
</html>